# Исправление проблем с брендингом

## Что было исправлено

### ✅ Проблема 1: Фотки не загружаются

**Причина**: Bucket `proposal-media` существует, но не имеет RLS политик для загрузки файлов.

**Решение**:
1. Создана миграция `supabase/migrations/011_storage_policies.sql` с политиками
2. Добавлено подробное логирование в `BrandSettingsForm.tsx`

**Как применить**:
1. Откройте Supabase Dashboard: https://supabase.com/dashboard/project/qcxfgmmqnkjmeleupely
2. Перейдите в SQL Editor
3. Скопируйте и выполните содержимое файла `supabase/migrations/011_storage_policies.sql`

Или используйте инструкцию в `supabase/APPLY_STORAGE_MIGRATION.md`

### ✅ Проблема 2: Выбор шрифта не меняет превью

**Причина**: 
1. Google Fonts не загружались динамически
2. Шрифты не применялись с правильным синтаксисом CSS

**Решение**:
1. Добавлена динамическая загрузка Google Fonts в `BrandPreview.tsx`
2. Исправлен синтаксис fontFamily: теперь `'Font Name', sans-serif`
3. Шрифты загружаются автоматически при изменении настроек

## Тестирование

После применения миграции:

1. Откройте страницу брендинга
2. **Тест загрузки логотипа**:
   - Нажмите "Choose File" в секции Logo
   - Выберите изображение (PNG, JPG, SVG, до 2MB)
   - Откройте консоль браузера (F12)
   - Проверьте логи загрузки
   - Логотип должен появиться в превью справа

3. **Тест шрифтов**:
   - Измените "Primary Font" на любой другой (например, Roboto)
   - Превью справа должно сразу обновиться
   - Заголовки должны отобразиться новым шрифтом
   - Попробуйте разные комбинации шрифтов

4. **Тест цветов**:
   - Измените Primary Color
   - Заголовок "Commercial Proposal" должен изменить цвет
   - Кнопка "Primary Button" должна изменить цвет

## Логирование

Теперь при загрузке логотипа в консоли будут видны подробные логи:
- Информация о выбранном файле
- Процесс загрузки в Supabase Storage
- Полученный публичный URL
- Любые ошибки с деталями

Это поможет быстро диагностировать проблемы.

## Дополнительные улучшения

- Добавлена валидация типа файла (только изображения)
- Добавлена валидация размера файла (макс 2MB)
- Улучшены сообщения об ошибках
- Шрифты загружаются с Google Fonts автоматически
- Превью обновляется в реальном времени через BroadcastChannel
- **Карточка "Project Overview" теперь адаптивная**: автоматически выбирает контрастный цвет фона и текста в зависимости от выбранного цвета фона (светлый/темный)
